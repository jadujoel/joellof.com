"use strict";(()=>{var x=(n,o,t)=>new Promise((e,r)=>{var i=d=>{try{m(t.next(d))}catch(g){r(g)}},a=d=>{try{m(t.throw(d))}catch(g){r(g)}},m=d=>d.done?e(d.value):Promise.resolve(d.value).then(i,a);m((t=t.apply(n,o)).next())});var V=Object.defineProperty,q=(n,o,t)=>o in n?V(n,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[o]=t,A=(n,o,t)=>(q(n,typeof o!="symbol"?o+"":o,t),t);function S(){}var G={typename:"none",debug:S,log:S,info:S,warn:S,error:S,table:S,trace:S},w=H;function H(){return G}function P(n,o){return Object.prototype.hasOwnProperty.call(n,o)}function f(n,o,t){Object.defineProperty(n,o,t)}function T(...n){return n}var $,U,J;U=Symbol.toStringTag,J=Symbol.iterator,$=new WeakMap;function Q(n){return(...o)=>{try{return[null,n(...o)]}catch(t){return[t,null]}}}function X(n){var o;let t=(o=n.AudioParam)==null?void 0:o.prototype;if(t===void 0){w().debug("[polyfill]: (AudioParam) no AudioParam.prototype found. Skipping polyfill.");return}!P(t,"cancelAndHoldAtTime")&&P(t,"cancelScheduledValues")&&(w().debug("[polyfill]: (AudioParam) installing cancelAndHoldAtTime"),f(t,"cancelAndHoldAtTime",{value:t.cancelScheduledValues})),P(t,"automationRate")||(w().debug("[polyfill]: (AudioParam) installing automationRate"),f(t,"automationRate",{value:"a-rate"}))}function z(n=window){let o=n.AudioContext.prototype;class t{constructor(a,m={pan:0}){A(this,"_input"),A(this,"_output"),A(this,"context"),A(this,"pan"),A(this,"channelCount",2),A(this,"channelCountMode","clamped-max"),A(this,"channelInterpretation","speakers"),A(this,"numberOfInputs",1),A(this,"numberOfOutputs",1),A(this,"addEventListener",()=>{}),A(this,"dispatchEvent",()=>{}),A(this,"removeEventListener",()=>{}),A(this,"isStereoPannerNode",!0);var d;this.context=a,this._input=this.context.createGain(),this._output=this.context.createGain();let g=(d=m.pan)!=null?d:0,l=this.context.createChannelSplitter(2),b=this.context.createGain(),p=this.context.createGain(),y=this.context.createGain(),k=this.context.createGain(),O=this.context.createChannelMerger(2),C=this.context.createChannelMerger(2),E=this.context.createChannelMerger(2);this._input.connect(l),l.connect(b,0),l.connect(p,0),l.connect(y,1),l.connect(k,1),b.connect(O,0,0),k.connect(O,0,0),y.connect(C,0,1),p.connect(C,0,1),O.connect(E,0,0),C.connect(E,0,1),E.connect(this._output),this.pan={get value(){return g},set value(c){b.gain.value=1-Math.max(c,0),k.gain.value=-Math.min(c,0),y.gain.value=1+Math.min(c,0),p.gain.value=Math.max(c,0),g=c},get automationRate(){return"a-rate"},get defaultValue(){return 0},get maxValue(){return 1},get minValue(){return-1},cancelAndHoldAtTime:c=>(T(c),this.pan),cancelScheduledValues:c=>(T(c),this.pan),exponentialRampToValueAtTime:(c,h)=>(T(h),this.pan.value=c,this.pan),linearRampToValueAtTime:(c,h)=>(T(h),this.pan.value=c,this.pan),setTargetAtTime:(c,h,u)=>(T(h,u),this.pan.value=c,this.pan),setValueAtTime:(c,h)=>(T(h),this.pan.value=c,this.pan),setValueCurveAtTime:(c,h,u)=>(T(h,u),this.pan.value=Number(c[0]),this.pan)},this.pan.value=g}connect(...a){this._output.connect.apply(this._output,a)}disconnect(...a){this._output.disconnect.apply(this._output,a)}toString(){return"StereoPannerNode"}}function e(i,a){return new t(i,a)}f(o,"createStereoPanner",{value:function(i){return e(this,i)}});let r=n.AudioNode.prototype.connect;f(n.AudioNode.prototype,"connect",{value:function(i,a,m){function d(g){return P(g,"isStereoPannerNode")&&g.isStereoPannerNode===!0}return d(i)&&(i=i._input),r.call(this,i,a!=null?a:0,m!=null?m:0)}})}function K(n){if(n.webkitAudioContext==null)throw Error("[polyfill]: cannot install webkitAudioContext polyfill since webkitAudioContext does not exist on global.");function o(e){e!=null&&e.setTargetAtTime===void 0&&f(e,"setTargetAtTime",{value:e.setTargetValueAtTime})}let t=n.webkitAudioContext.prototype;P(t,"createScriptProcessor")||f(t,"createScriptProcessor",{value:t.createJavaScriptNode}),P(t,"createPeriodicWave")||f(t,"createPeriodicWave",{value:t.createWaveTable}),P(t,"createGain")||f(t,"createGain",{value:function(){let e=this.createGainNode();return o(e.gain),e}}),P(t,"createDelay")||f(t,"createDelay",{value:function(e){let r=this.createDelayNode(e);return o(r.delayTime),r}}),f(t,"internal_createBufferSource",{value:t.createBufferSource}),t.createBufferSource=function(){let e=this.internal_createBufferSource();return e.start===void 0?e.start=function(r,i,a){i!==void 0||a!==void 0?this.noteGrainOn(r!=null?r:0,i,a):this.noteOn(r!=null?r:0)}:(f(e,"internal_start",{value:e.start}),e.start=function(r,i,a){e.internal_start(r!=null?r:0,i!=null?i:0,a)}),e.stop===void 0?e.stop=function(r=0){this.noteOff(r)}:(f(e,"internal_stop",{value:e.stop}),e.stop=function(r=0){e.internal_stop(r)}),o(e.playbackRate),e},f(t,"internal_createDynamicsCompressor",{value:t.createDynamicsCompressor}),t.createDynamicsCompressor=function(){let e=this.internal_createDynamicsCompressor();return o(e.threshold),o(e.knee),o(e.ratio),o(e.reduction),o(e.attack),o(e.release),e},f(t,"internal_createBiquadFilter",{value:t.createBiquadFilter}),t.createBiquadFilter=function(){let e=this.internal_createBiquadFilter();return o(e.frequency),o(e.detune),o(e.Q),o(e.gain),e},P(t,"createOscillator")&&(f(t,"internal_createOscillator",{value:t.createOscillator}),t.createOscillator=function(){let e=this.internal_createOscillator();return e.start===void 0?e.start=function(r=0){this.noteOn(r)}:(f(e,"internal_start",{value:e.start}),e.start=function(r){e.internal_start(r)}),e.stop===void 0?e.stop=function(r=0){this.noteOff(r)}:(f(e,"internal_stop",{value:e.stop}),e.stop=function(r=0){e.internal_stop(r)}),e.setPeriodicWave===void 0&&(e.setPeriodicWave=e.setWaveTable),o(e.frequency),o(e.detune),e}),f(t,"internal_decodeAudioData",{value:t.decodeAudioData}),t.decodeAudioData=function(e,r,i){return x(this,null,function*(){return yield new Promise((a,m)=>{this.internal_decodeAudioData(e,d=>{r!=null&&r(d),a(d)},d=>{i!=null&&i(d),m(d)})})})},f(n,"AudioContext",{value:n.webkitAudioContext})}function Y(n,o=window){let t={AudioParam:"AudioParam"in o,AudioContext:"AudioContext"in o,OfflineAudioContext:"OfflineAudioContext"in o,webkitAudioContext:"webkitAudioContext"in o,webkitOfflineAudioContext:"webkitOfflineAudioContext"in o,createStereoPanner:"AudioContext"in o&&"createStereoPanner"in o.AudioContext.prototype||"webkitAudioContext"in o&&"createStereoPanner"in o.webkitAudioContext},e={AudioParam:n.AudioParam===!0||t.AudioParam,webkitAudioContext:n.webkitAudioContext===!0||t.webkitAudioContext&&!t.AudioContext,webkitOfflineAudioContext:n.webkitOfflineAudioContext===!0||t.webkitOfflineAudioContext&&!t.OfflineAudioContext,createStereoPanner:n.createStereoPanner===!0||!t.createStereoPanner};w().debug("[polyfill]:",t);let r=i=>{let[a]=Q(i)(o);return a!=null&&w().error(a),a==null};return{AudioParam:e.AudioParam===!0&&r(()=>{w().debug("[polyfill]: installing AudioParam"),X(o)}),webkitAudioContext:e.webkitAudioContext===!0&&r(()=>{w().debug("[polyfill]: installing webkitAudioContext"),K(o)}),webkitOfflineAudioContext:e.webkitOfflineAudioContext===!0&&r(()=>{w().debug("[polyfill]: installing webkitOfflineAudioContext"),f(o,"OfflineAudioContext",{value:o.webkitOfflineAudioContext})}),createStereoPanner:e.createStereoPanner===!0&&r(()=>{w().debug("[polyfill]: installing createStereoPanner"),z(o)})}}function F(n={}){return Y(n)}F();function N(d){return x(this,arguments,function*({Webm:n,Mp4:o,Mp3:t,Ogg:e,Opus:r,Wav:i,CafShort:a,CafLong:m}){let[g,l]=yield h(y)().catch(C),b=l===null?{ContextError:g}:{Webm:n===void 0?null:yield p(l,n),Mp4:o===void 0?null:yield p(l,o),Mp3:t===void 0?null:yield p(l,t),Ogg:e===void 0?null:yield p(l,e),Opus:r===void 0?null:yield p(l,r),Wav:i===void 0?null:yield p(l,i),CafShort:a===void 0?null:yield p(l,a),CafLong:m===void 0?null:yield p(l,m)};return l==null||l.close().catch(C),b;function p(u,v){return x(this,null,function*(){let[s,M]=yield h(W)(v).catch(C),[R,L]=yield h(k)(u,M).catch(C),[_]=c(O)(u,L);return{Success:s===null&&R===null&&_===null,FetchError:s,ArrayBufferError:s,DecodeError:R,PlaybackError:_}})}function y(){return x(this,null,function*(){let u=v=>{let s=()=>{let M=new AudioContext;removeEventListener("click",s),removeEventListener("keypress",s),removeEventListener("touchstart",s),v(M)};addEventListener("click",s,{once:!0}),addEventListener("keypress",s,{once:!0}),addEventListener("touchstart",s,{once:!0})};return yield new Promise(u)})}function k(u,v){return x(this,null,function*(){return yield u.decodeAudioData(v)})}function O(u,v){let s=u.createBufferSource();s.buffer=v,s.connect(u.destination),s.start()}function C(u){return[E(u),null]}function E(u){return u instanceof Error?u:new Error(JSON.stringify(u))}function c(u){return(...v)=>{try{return[null,u(...v)]}catch(s){return[E(s),null]}}}function h(u){return(...v)=>x(this,null,function*(){try{return[null,yield u(...v).catch(E)]}catch(s){return[E(s),null]}})}})}function W(n){return x(this,null,function*(){return yield new Promise((o,t)=>{let e=new XMLHttpRequest;e.open("GET",n,!0),e.responseType="arraybuffer",e.addEventListener("abort",()=>{t(new Error(`Request for ${n} aborted`))}),e.addEventListener("timeout",()=>{t(new Error(`Request for ${n} timed out`))}),e.addEventListener("load",()=>{let r=e.response;r instanceof ArrayBuffer&&r.byteLength!==0?o(r):t(new Error("invalid response"))}),e.addEventListener("error",()=>{t(new Error(`error when requesting: '${n}'`))}),e.send()})})}F();console.log("hello from the app side");function Z(){var o,t;let n=(t=(o=window.AudioContext)!=null?o:window.webkitAudioContext)!=null?t:null;return new n}N({Webm:"silence.webm",Mp4:"silence.mp4",Mp3:"silence.mp3",Ogg:"silence.ogg",Opus:"silence.opus",CafShort:"silence.caf",CafLong:"silence-long.caf",Wav:"silence.wav"}).then(n=>{console.log("Test Audio Format Support Result:",n);function o(b,p,y){var s,M,R,L,_,D,I,j;let{ArrayBufferError:k,DecodeError:O,FetchError:C,PlaybackError:E}=y,c=k!==null?`<li class="failure">ArrayBufferError: ${(M=(s=y.ArrayBufferError)==null?void 0:s.message)!=null?M:""}</p>`:"",h=O!==null?`<li class="failure">DecodeError: ${(L=(R=y.DecodeError)==null?void 0:R.message)!=null?L:""}</p>`:"",u=C!==null?`<li class="failure">FetchError: ${(D=(_=y.FetchError)==null?void 0:_.message)!=null?D:""}</p>`:"",v=E!==null?`<li class="failure">PlaybackError: ${(j=(I=y.PlaybackError)==null?void 0:I.message)!=null?j:""}</p>`:"";b.innerHTML=`<p class="failure">${p} is not supported:</p><ul>`+c+h+u+v+"</ul>"}function t(b,p,y){y.Success?b.innerHTML=`<p class="success">${p} is supported</p>`:o(b,p,y)}document.getElementById("context").innerHTML=n.ContextError!=null?'<p class="failure">AudioContext is not supported:</p>':'<p class="success">AudioContext is supported</p>',n.Webm!==null&&n.Webm!==void 0&&t(document.getElementById("webm"),"Webm",n.Webm),n.Mp4!==null&&n.Mp4!==void 0&&t(document.getElementById("mp4"),"Mp4",n.Mp4),n.CafShort!==null&&n.CafShort!==void 0&&t(document.getElementById("caf-short"),"CafShort",n.CafShort),n.CafLong!==null&&n.CafLong!==void 0&&t(document.getElementById("caf-long"),"CafLong",n.CafLong),n.Mp3!==null&&n.Mp3!==void 0&&t(document.getElementById("mp3"),"Mp3",n.Mp3),n.Ogg!==null&&n.Ogg!==void 0&&t(document.getElementById("ogg"),"Ogg",n.Ogg),n.Opus!==null&&n.Opus!==void 0&&t(document.getElementById("opus"),"Opus",n.Opus),n.Wav!==null&&n.Wav!==void 0&&t(document.getElementById("wav"),"Wav",n.Wav);function e(){B("bass.webm")}function r(){B("bass.mp4")}function i(){B("bass.mp3")}function a(){B("bass.ogg")}function m(){B("bass.opus")}function d(){B("bass.caf")}function g(){B("bass.wav")}function l(b,p){let y=document.createElement("button");y.innerHTML=p,y.addEventListener("click",b),document.getElementById("buttons").appendChild(y)}l(e,"Play Webm"),l(r,"Play Mp4"),l(i,"Play Mp3"),l(a,"Play Ogg"),l(m,"Play Opus"),l(d,"Play Caf"),l(g,"Play Wav")}).catch(console.error);function B(n){console.log("playUrl",n);let o=Z(),t=o.createBufferSource();W(n).then(e=>x(this,null,function*(){return yield o.decodeAudioData(e)})).then(e=>{t.buffer=e,t.connect(o.destination),t.start()}).catch(console.error)}})();
//# sourceMappingURL=app.mjs.map
